<!DOCTYPE html>
<html lang="en">
<head>

<script>

function toggleDebug(){
chrome.storage.local.get('ncgcdebug', function (result) {
		if(result==undefined)result={debug:true};
		if(result.ncgcdebug!=true){
			result.ncgcdebug=true;
		}else{
			result.ncgcdebug=false;
		}
		chrome.storage.local.set({'ncgcdebug': result.ncgcdebug}, function (result2) {
				if(result.ncgcdebug){
					document.getElementById("status").innerHTML = "Notifications ON";	
				}else{
					document.getElementById("status").innerHTML = "Notifications OFF";			
				}
   		});
	});
}
function toggle(){
	chrome.storage.local.get('ncgchover', function (result) {
		if(result==undefined)result={ncgchover:true};
		if(result.ncgchover!=true && result.ncgchover!=undefined){
			result.ncgchover=true;
			force();
		}else{
			result.ncgchover=false;
			forceoff();
		}
		chrome.storage.local.set({'ncgchover': result.ncgchover}, function (result2) {
				if(result.ncgchover){
					document.getElementById("status").innerHTML = "Hover ON";	
				}else{
					document.getElementById("status").innerHTML = "Hover OFF";			
				}
   		});
	});
}
function toggleRefresh(){
	chrome.storage.local.get('ncgchoverRefresh', function (result) {
		if(result==undefined)result={};
		if(result.ncgchoverRefresh!=false){
			result.ncgchoverRefresh=false;
		}else{
			result.ncgchoverRefresh=true;
			//forceRefresh("refreshOff");
		}
		
		chrome.storage.local.set({'ncgchoverRefresh': result.ncgchoverRefresh}, function (result2) {
				if(result.ncgchoverRefresh){
					document.getElementById("statusRefresh").innerHTML = "Refresh ON";	
				}else{
					document.getElementById("statusRefresh").innerHTML = "Refresh OFF";			
				}
   		});
	});
}
function forceRefresh(ref){
    chrome.tabs.query({active: true, currentWindow: true}, function(tabs) {
    	chrome.tabs.sendMessage(tabs[0].id, {greeting: ref}, function(response) {
    		console.log(response.farewell);
  		});
	});
}
function force(){
    chrome.tabs.query({active: true, currentWindow: true}, function(tabs) {
  chrome.tabs.sendMessage(tabs[0].id, {greeting: "mark"}, function(response) {
    console.log(response.farewell);
  });
});
}
function img(){
	chrome.runtime.sendMessage({type: "capture"}, function(response) {});
	window.close();
	return;
}
function forceoff(){
   chrome.tabs.query({active: true, currentWindow: true}, function(tabs) {
  chrome.tabs.sendMessage(tabs[0].id, {greeting: "unmark"}, function(response) {
    console.log(response.farewell);
  });
});
}
</script>
</head>
<body style="width:300px">
<form>
<input id='chk' type="checkbox" onclick="toggle();" value="hover" checked>Automatic Captions<br>
<input id='chkb' type="checkbox" onclick="toggleRefresh();" value="hoverRefresh" checked>Periodic Refresh<br>
<input id='chkmessage' type="checkbox" onclick="toggleDebug();" value="hoverRefresh2" checked>Notifications<br>

<div id="status"></div>
<div id="statusRefresh"></div>

<button onclick="force();">Add Captions</button>
<button onclick="forceoff();">Remove Captions</button>
<button onclick="img();">Image to Structure</button>
</form>
<script>
chrome.storage.local.get('ncgchover', function (result) {
	if(result==undefined)result={};
	if(result.ncgchover!=true && result.ncgchover!=undefined){
		document.getElementById("chk").checked=false;
	}else{
		document.getElementById("chk").checked=true;
	}
});
chrome.storage.local.get('ncgchoverRefresh', function (result) {
	if(result==undefined)result={};
	if(result.ncgchoverRefresh!=false){
		document.getElementById("chkb").checked=true;
	}else{
		document.getElementById("chkb").checked=false;
	}
});
chrome.storage.local.get('ncgcdebug', function (result) {
	if(result==undefined)result={};
	if(result.ncgcdebug!=true){
		document.getElementById("chkmessage").checked=false;
	}else{
		document.getElementById("chkmessage").checked=true;
	}
});
</script>
</body>

</html>